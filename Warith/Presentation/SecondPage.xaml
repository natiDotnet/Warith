<Page x:Class="Warith.Presentation.SecondPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:local="using:Warith.Presentation"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:uen="using:Uno.Extensions.Navigation.UI"
      xmlns:utu="using:Uno.Toolkit.UI"
      xmlns:um="using:Uno.Material"
      Background="{ThemeResource BackgroundBrush}">

  <Page.Resources>
    <local:HideIfEmptyConverter x:Key="HideIfEmptyConverter" />
  </Page.Resources>

  <Grid utu:SafeArea.Insets="VisibleBounds">
    <VisualStateManager.VisualStateGroups>
      <VisualStateGroup x:Name="AdaptiveStates">
        <VisualState x:Name="NarrowState">
          <VisualState.StateTriggers>
            <AdaptiveTrigger MinWindowWidth="0" />
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="MessageTextBlock.Width" Value="300" />
          </VisualState.Setters>
        </VisualState>
        <VisualState x:Name="WideState">
          <VisualState.StateTriggers>
              <AdaptiveTrigger MinWindowWidth="600" />
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="MessageTextBlock.Width" Value="800" />
          </VisualState.Setters>
        </VisualState>
      </VisualStateGroup>
    </VisualStateManager.VisualStateGroups>

    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="Auto" />
      <RowDefinition />
    </Grid.RowDefinitions>
    <Image Grid.Row="0"
           Source="https://almwareeth.com/images/faredat_almwareeth.webp"
           HorizontalAlignment="Center"
           Stretch="Fill"
           MaxHeight="150"
           Margin="10"/>
    <utu:NavigationBar Grid.Row="1" Content="Inheritance Results"/>

    <Grid Grid.Row="2"
          Margin="16"
          HorizontalAlignment="Center"
          MaxWidth="800">
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition Height="Auto" />
        <RowDefinition Height="*" />
      </Grid.RowDefinitions>

      <TextBlock x:Name="MessageTextBlock"
                 Text="{Binding WarethResponse.Message}"
                 HorizontalAlignment="Center"
                 TextAlignment="Center"
                 Margin="0,0,0,16"
                 FontSize="16"
                 FontWeight="SemiBold"
                 TextWrapping="Wrap"
                 Grid.Row="0"
                 Width="800"/>

      <!-- Table Header -->
      <Border Grid.Row="1"
              Background="{ThemeResource SurfaceContainerHighBrush}"
              CornerRadius="8,8,0,0"
              Padding="12,8"
              Visibility="{Binding WarethResponse.Result, Converter={StaticResource HideIfEmptyConverter}}">
        <Grid>
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
          </Grid.ColumnDefinitions>
          <TextBlock Text="Percent" FontWeight="Bold" HorizontalAlignment="Center" />
          <StackPanel Grid.Column="1" HorizontalAlignment="Center">
            <TextBlock Text="Share" FontWeight="Bold" HorizontalAlignment="Center" />
            <TextBlock Text="(each one)" FontSize="10" Foreground="Red" HorizontalAlignment="Center" />
          </StackPanel>
          <TextBlock Grid.Column="2" Text="Count" FontWeight="Bold" HorizontalAlignment="Center" />
          <TextBlock Grid.Column="3" Text="Heir Name" FontWeight="Bold" HorizontalAlignment="Left" Margin="12,0,0,0" />
        </Grid>
      </Border>

      <!-- Results List -->
      <ListView Grid.Row="2"
                ItemsSource="{Binding WarethResponse.Result}"
                SelectionMode="None"
                Background="{ThemeResource SurfaceContainerBrush}"
                Padding="0,0,0,8"
                Visibility="{Binding WarethResponse.Result, Converter={StaticResource HideIfEmptyConverter}}">
        <ListView.ItemTemplate>
          <DataTemplate>
            <Grid Padding="12,16">
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
              </Grid.ColumnDefinitions>

              <StackPanel Orientation="Horizontal"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center">
                <TextBlock Text="{Binding Percent}"
                           Foreground="{ThemeResource PrimaryBrush}"
                           FontWeight="SemiBold" />
                <TextBlock Text="%"
                           Foreground="{ThemeResource PrimaryBrush}"
                           FontWeight="SemiBold" />
              </StackPanel>

              <TextBlock Grid.Column="1"
                         Text="{Binding Share}"
                         HorizontalAlignment="Center"
                         VerticalAlignment="Center" />

              <TextBlock Grid.Column="2"
                         Text="{Binding Count}"
                         HorizontalAlignment="Center"
                         VerticalAlignment="Center" />

              <TextBlock Grid.Column="3"
                         Text="{Binding Heir}"
                         HorizontalAlignment="Left"
                         VerticalAlignment="Center"
                         Margin="12,0,0,0"
                         FontWeight="Medium" />
            </Grid>
          </DataTemplate>
        </ListView.ItemTemplate>
      </ListView>
    </Grid>

  </Grid>
</Page>
